!function(e){"function"==typeof define&&define.amd?define("happyloader",["jquery"],e):e(jQuery)}(function(e){function i(i,t){this.element=i,this.$element=e(this.element),this.$body=e("body"),this.urls=[],this.imageCounter=0,this.options=e.extend({},r,t,e(this.element).data("happyloader-options")),this._defaults=r,this._name=s,this.version=a,this.init(),this.bindMethods(),this.bindEventListeners()}function t(){this.each(function(){e.data(this,"plugin_"+s).renderBar()})}function n(e,i){return function(){return e.apply(i,arguments)}}function o(e,i,t){e.on(i,t)}var a="1.0.0",s="happyloader",r={happyloaderOverlay:"happy-loader-overlay",happyloaderBar:"happy-loader-bar",happyloaderImages:"happyloader-images",happyloaderInformer:"happy-loader-informer",debug:!1,callback:function(){}};i.prototype={init:function(){this.render(),this.findImagesElements()},render:function(){e("<div/>").addClass(this.options.happyloaderOverlay).appendTo("body"),e("<div/>").addClass(this.options.happyloaderImages).css("display","none").appendTo("body"),e("<div/>").addClass(this.options.happyloaderBar).appendTo("."+this.options.happyloaderOverlay),e("<div/>").addClass(this.options.happyloaderInformer).html("0%").appendTo("."+this.options.happyloaderOverlay)},renderBar:function(){var i=parseInt(100*this.imageCounter/this.urls.length),t=e(window).width(),n=parseInt(i*t/100);e("."+this.options.happyloaderBar).stop(!0,!0).animate({width:n},300,e.proxy(function(){e("."+this.options.happyloaderInformer).html(i+"%")},this))},removeLoader:function(){e("."+this.options.happyloaderBar).promise().done(e.proxy(function(){e("."+this.options.happyloaderImages).remove(),e("."+this.options.happyloaderOverlay).animate({opacity:0},300,e.proxy(function(){e("."+this.options.happyloaderOverlay).remove(),1==this.options.debug&&console.log("end loader")},this)),this.options.callback()},this))},draw:function(){},findImagesElements:function(){var e=this.$element.find("*:not(script)");e=e.add(this.$element);for(var i=e.size(),t=0;i>t;t++)this.findImage(e[t]);return this.urls.length<=0?(this.removeLoader(),!0):(this.createImages(this.urls),void(1==this.options.debug&&console.log("end find images",this.urls)))},findImage:function(i){var i=e(i),t=i[0].tagName.toLowerCase(),n="";if("none"==i.css("background-image")&&1==i.is("[src]")&&"img"==t&&(n=i.attr("src"),findUrl=n.toLowerCase(),findUrl.indexOf("jpg")+1>0||findUrl.indexOf("jpeg")+1>0||findUrl.indexOf("png")+1>0||findUrl.indexOf("gif")+1>0))return this.urls.push(n),!0;if("none"!==i.css("background-image")){if(n=i.css("background-image"),n.indexOf("gradient")+1>0)return!1;if(n.indexOf("data")+1>0)return!1;if(n=n.replace(/url\(\"/g,""),n=n.replace(/url\(/g,""),n=n.replace(/\"\)/g,""),n=n.replace(/\)/g,""),n.indexOf(",")+1>0){for(var o=n.split(","),a=0,s=o.length;s>a;a++)this.urls.push(o[a].replace(/^\%20|\%20$/g,""));return!0}return this.urls.push(n),!0}},loadImage:function(i){i.on("load error",e.proxy(function(){this.completeImageLoad(i),1==this.options.debug&&console.log("load image")},this))},completeImageLoad:function(){this.imageCounter++;this.urls.length;this.renderBar(this.imageCounter),this.imageCounter>=this.urls.length&&this.removeLoader()},createImages:function(){for(var i=this.urls.length,t="",n=0;i>n;n++)t=e("<img />"),t.attr("src",this.urls[n]).appendTo("."+this.options.happyloaderImages),this.loadImage(t)},bindMethods:function(){},bindEventListeners:function(){}},e.fn[s]=function(a){return t=n(t,this),o(e(window),"load",t),o(e(window),"resize",t),this.each(function(){e.data(this,"plugin_"+s)||e.data(this,"plugin_"+s,new i(this,a))})}});
//# sourceMappingURL=jquery.happyloader.min.js.map